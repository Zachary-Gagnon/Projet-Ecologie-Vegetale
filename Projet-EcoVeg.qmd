---
title: "Projet-EcoVeg"
author: "Gagnon, Zachary; Plasse, Tristan; Marcotte, Loïc; Bussières, Xavier"
format: pptx
editor: visual
---

### Vérification et installation des packages manquants si nécessaire

```{r}
packages_needed<-c("tidyverse", "readxl", "sf", "ggspatial", "patchwork", "janitor", "tinytable", "here", "cowplot", "writexl") 

packages_to_install <- packages_needed[!(packages_needed %in% installed.packages()[,"Package"])]
if(length(packages_to_install)) install.packages(packages_to_install)
```

------------------------------------------------------------------------

### Importation des données brutes

```{r}
donnees <- readxl::read_xlsx(here::here("Echantillonnage_sel.xlsx"))

rues<-unique(donnees$Rue)
for (rue in 1:4) {
  for (point in 0:29) {
    subset_donnees <- donnees[donnees$Point == point & donnees$Rue == rues[rue], ]
    if (nrow(subset_donnees) > 0) {
      for (i in 17:79) {
        espece_col <- colnames(donnees)[i]
        for (j in 1:nrow(subset_donnees)){
          if (subset_donnees$Espece[j] %in% espece_col){
          donnees[donnees$Point == point & donnees$Rue == rues[rue],subset_donnees$Espece[j]] <- subset_donnees$Recouvrement[subset_donnees$Espece==subset_donnees$Espece[j]]
            }
          }
        }
      }
    }
  }
donnees<-donnees[,!names(donnees) %in% c("Espece", "Recouvrement")]
donnees<-unique(donnees)
```

Ici, nous avons simplement créer un colonne pour chaque espèce retrouvé sur l'ensemble des points afin de pouvoir inscrire le recouvrement de chaque espèce dans sa colonne respective pour chaque point et ainsi obtenir qu'une seule linge par point. Cela rend la manipulation de données plus simple par la suite.

```{r}
write_xlsx(donnees,"bdd_equipe4.xlsx")
```

Pour exporter la base de données afin de la remettre

------------------------------------------------------------------------

### Traitement de la base de données pour les analyses statistiques

Premièrement, afin de pouvoir traité chaque espèce/condition dominante autour des points, nous avons divisé l'habitat en plusieurs colonnes. Nous devons donc regroupé ces colonnes au sein d'une seule variable « Habitat »

```{r}
bdd<-donnees
bdd$Habitat <- lapply(seq_len(nrow(bdd)), function(i) {
  na.omit(as.character(bdd[i, c("Habitat1", "Habitat2", "Habitat3")]))
})
bdd<-bdd[,!names(bdd) %in% c("Habitat1", "Habitat2", "Habitat3")]
```

Plusieurs points n'ont pas pu être échantillonné pour certaines raisons. Nous devons alors exclure ces points de l'analyse statistique

```{r}
bdd<-bdd[!bdd$Poids=="NA",]

```

### Analyses statistiques

On se rappelle que le but de notre étude est principalement de déterminer si le traitement au sel affecte la biomasse de la végétation bordant ces routes.

```{r}
sel<-bdd[bdd$Sel==1,]
sans_sel<-bdd[bdd$Sel==0,]
#vérificaton de la normalité

```

De plus, on cherche à identifier si le traitement au sel peut également affecté la composition de ces communautés végétales
